<ContentDialog
    x:Class="Magehelper.Views.Dialogs.AddArtifactSpellDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:CommunityToolkit.WinUI.UI.Converters;assembly=CommunityToolkit.WinUI.UI"
    xmlns:vm="clr-namespace:Magehelper.ViewModels.Dialogs"
    Title="{Binding DialogTitle}"
    CloseButtonText="Abbrechen"
    PrimaryButtonCommand="{Binding AddSpellCommand}"
    PrimaryButtonText="Hinzufügen"
    Style="{ThemeResource DefaultContentDialogStyle}">
    <ContentDialog.DataContext>
        <vm:AddArtifactSpellDialogViewModel />
    </ContentDialog.DataContext>
    <ContentDialog.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </ContentDialog.Resources>
    <StackPanel>
        <ComboBox
            Margin="10"
            ItemsSource="{Binding SpellNames, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
            SelectedValue="{Binding SelectedSpellName}" />
        <Grid Margin="5" Visibility="{Binding IsStaffSpell, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="Merkmal"
                Visibility="{Binding IsCharacteristicVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <ComboBox
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                ItemsSource="{Binding Characteristics, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                SelectedValue="{Binding SelectedCharacteristic}"
                Visibility="{Binding IsCharacteristicVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="Variante"
                Visibility="{Binding IsReptileSkinSelected, Converter={StaticResource BoolToVisibilityConverter}}" />
            <ComboBox
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                ItemsSource="{Binding ReptileSkinVariants, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                SelectedValue="{Binding SelectedReptileSkinVariant}"
                Visibility="{Binding IsReptileSkinSelected, Converter={StaticResource BoolToVisibilityConverter}}" />
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="Volumenpunkte"
                Visibility="{Binding IsSpellPointsVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <NumberBox
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                KeyDown="UIElement_OnKeyDown"
                Maximum="{Binding MaxSpellPoints}"
                Minimum="{Binding MinSpellPoints}"
                SpinButtonPlacementMode="Compact"
                Visibility="{Binding IsSpellPointsVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                Value="{Binding SpellPoints, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="RKP"
                Visibility="{Binding IsHammerSelected, Converter={StaticResource BoolToVisibilityConverter}}" />
            <StackPanel
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                Orientation="Horizontal"
                Visibility="{Binding IsHammerSelected, Converter={StaticResource BoolToVisibilityConverter}}">
                <NumberBox
                    KeyDown="UIElement_OnKeyDown"
                    Maximum="{Binding MaxSpellPoints}"
                    Minimum="{Binding MinSpellPoints}"
                    SpinButtonPlacementMode="Compact"
                    Value="{Binding HammerRkp, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                <Button Command="{Binding RollHammerCommand}" IsEnabled="{Binding CanRollHammer}">
                    <Image Source="../../Assets/dice.png" />
                </Button>
            </StackPanel>
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="Patzer"
                Visibility="{Binding IsFlameSwordSelected, Converter={StaticResource BoolToVisibilityConverter}}" />
            <StackPanel
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                Orientation="Horizontal"
                Visibility="{Binding IsHammerSelected, Converter={StaticResource BoolToVisibilityConverter}}">
                <RadioButton
                    Content="4"
                    IsChecked="{Binding IsFlameSwordFourChecked}"
                    Visibility="{Binding AreFlameSwordRadioButtonsVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
                <RadioButton
                    Content="5"
                    IsChecked="{Binding IsFlameSwordFiveChecked}"
                    Visibility="{Binding AreFlameSwordRadioButtonsVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
                <TextBlock
                    Text="{Binding FlameSwordFailureText}"
                    TextWrapping="Wrap"
                    Visibility="{Binding IsFlameSwordFailureTextVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
                <Button Command="{Binding RollFlameSwordCommand}" IsEnabled="{Binding CanRollFlameSword}">
                    <Image Source="../../Assets/dice.png" />
                </Button>
            </StackPanel>
        </Grid>
        <Grid Margin="5" Visibility="{Binding IsCrystallBallSpell, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <TextBlock
                Grid.Row="0"
                Grid.Column="0"
                Margin="5"
                Text="Variante wählen"
                Visibility="{Binding IsSpellVariantVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <ComboBox
                Grid.Row="0"
                Grid.Column="1"
                Margin="5"
                ItemsSource="{Binding SpellVariants, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                SelectedValue="{Binding SpellVariants}"
                Visibility="{Binding IsSpellVariantVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <TextBlock
                Grid.Row="1"
                Grid.Column="0"
                Margin="5"
                Text="Beschreibung"
                Visibility="{Binding IsVariantDescriptionVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
            <TextBox
                Grid.Row="1"
                Grid.Column="1"
                Visibility="{Binding IsVariantDescriptionVisible, Converter={StaticResource BoolToVisibilityConverter}}" />
        </Grid>
        <Border
            Margin="10"
            BorderBrush="Red"
            Visibility="{Binding IsErrorVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <TextBlock Background="#FF7F7F" Text="{Binding ErrorText}" />
        </Border>
    </StackPanel>
</ContentDialog>
